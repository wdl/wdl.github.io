{
    "componentChunkName": "component---src-templates-blog-post-js",
    "path": "/docs/use-bungie-net-api-basic/",
    "result": {"data":{"site":{"siteMetadata":{"title":"Elenchus' Dev Docs"}},"markdownRemark":{"id":"ba893626-4891-5358-bea6-3f0053714a6e","excerpt":"Bungie.Net 홈페이지에서 App 등록하기 https://www.bungie.net/en/Application/에서 App 정보를 등록한다. 등록할 때 작성하는 데이터들은 모두 나중에 수정할 수 있다. 사용자 OAuth 인증 시키기 위에서 등록한 앱으로 들어오면 OAuth…","html":"<h2>Bungie.Net 홈페이지에서 App 등록하기</h2>\n<p><a href=\"https://www.bungie.net/en/Application/\">https://www.bungie.net/en/Application/</a>에서 App 정보를 등록한다.</p>\n<p>등록할 때 작성하는 데이터들은 모두 나중에 수정할 수 있다.</p>\n<h2>사용자 OAuth 인증 시키기</h2>\n<p>위에서 등록한 앱으로 들어오면 OAuth Authorization URL이 있다.</p>\n<p>OAuth Authorization URL에 OAuth <code class=\"language-text\">client_id</code>와 <code class=\"language-text\">response_type</code>을 Query string으로 GET 요청한다.</p>\n<p>이 때, <code class=\"language-text\">response_type</code>은 <code class=\"language-text\">code</code>로 고정한다.</p>\n<p>필요시 <code class=\"language-text\">state</code> 도 사용할 수 있다(요청과 콜백 사이의 상태를 유지하기 위해 클라이언트가 사용하는 임의값).</p>\n<div class=\"gatsby-highlight\" data-language=\"url\"><pre class=\"language-url\"><code class=\"language-url\"><span class=\"token scheme\">https<span class=\"token scheme-delimiter\">:</span></span><span class=\"token authority\"><span class=\"token authority-delimiter\">//</span><span class=\"token host\">www.bungie.net</span></span><span class=\"token path\"><span class=\"token path-separator\">/</span>en<span class=\"token path-separator\">/</span>OAuth<span class=\"token path-separator\">/</span>Authorize</span><span class=\"token query\"><span class=\"token query-delimiter\">?</span><span class=\"token pair\"><span class=\"token key\">client_id</span>=</span></span>[내 App의 OAuth client_id]&amp;response_type=code</code></pre></div>\n<p>이 주소를 사용자에게 띄우면 사용자가 Bungie.Net 인증을 할 수 있다.</p>\n<p>인증 후에는 아래 예시처럼 App 등록 때 설정한 <code class=\"language-text\">Redirect URL</code>로 <code class=\"language-text\">code</code>와 함께 돌아온다.</p>\n<div class=\"gatsby-highlight\" data-language=\"url\"><pre class=\"language-url\"><code class=\"language-url\"><span class=\"token scheme\">https<span class=\"token scheme-delimiter\">:</span></span><span class=\"token authority\"><span class=\"token authority-delimiter\">//</span></span>[내 서비스 주소]<span class=\"token query\"><span class=\"token query-delimiter\">?</span><span class=\"token pair\"><span class=\"token key\">code</span>=</span></span>[코드]</code></pre></div>\n<h2>OAuth Access Token 받기</h2>\n<p>OAuth Token 엔드포인트는 다음과 같다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">https://www.bungie.net/Platform/App/OAuth/token/</code></pre></div>\n<p>OAuth Token 엔드포인트에 다음 데이터를 <code class=\"language-text\">x-www-form-urlencoded</code>(Query string 형식)로 POST 요청낸다.</p>\n<ul>\n<li><code class=\"language-text\">grant_type</code>: <code class=\"language-text\">authorization_code</code>(<code class=\"language-text\">code</code>로 Access Token을 받아야하므로)</li>\n<li><code class=\"language-text\">code</code>: 위에서 인증을 받아 가져온 사용자의 <code class=\"language-text\">code</code></li>\n<li><code class=\"language-text\">client_id</code>: 내 App의 OAuth <code class=\"language-text\">client_id</code></li>\n</ul>\n<p>OAuth Client Type이 Confidential이라면 <code class=\"language-text\">Authorization</code> 헤더를 사용하거나 <code class=\"language-text\">client_secret</code> 데이터를 보내 자격 증명을 해야한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">// 예시 코드</span>\n<span class=\"token comment\">// import axios from 'axios';</span>\n<span class=\"token comment\">// import querystring from 'query-string';</span>\n\n<span class=\"token comment\">// ...</span>\n\n<span class=\"token keyword\">const</span> oAuthBody <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  grant_type<span class=\"token operator\">:</span> <span class=\"token string\">'authorization_code'</span><span class=\"token punctuation\">,</span>\n  code<span class=\"token operator\">:</span> __CODE<span class=\"token punctuation\">,</span> <span class=\"token comment\">// 사용자의 code</span>\n  client_id<span class=\"token operator\">:</span> __CLIENT_ID<span class=\"token punctuation\">,</span> <span class=\"token comment\">// 내 App의 OAuth client_id</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> axios<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span>\n  <span class=\"token string\">'https://www.bungie.net/Platform/App/OAuth/token/'</span><span class=\"token punctuation\">,</span>\n  querystring<span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>oAuthBody<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>그럼 아래와 같은 형식의 데이터가 온다.</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token comment\">// 예시 응답</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"access_token\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"2YotnFZFEjr1zCsicMWpAA\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"token_type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Bearer\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"expires_in\"</span><span class=\"token operator\">:</span> <span class=\"token number\">3600</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"refresh_token\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"tGzv3JOkF0XG5Qx2TlKWIA\"</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// Refresh Token은 Confidential Client App에만 옴</span>\n    <span class=\"token property\">\"refresh_expires_in\"</span><span class=\"token operator\">:</span> <span class=\"token number\">7776000</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// Refresh Token은 Confidential Client App에만 옴</span>\n    <span class=\"token property\">\"membership_id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"4352344\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2>GetBungieNetUserById 요청 해보기</h2>\n<p>이제 <a href=\"https://bungie-net.github.io/multi/operation_get_User-GetBungieNetUserById.html#operation_get_User-GetBungieNetUserById\">GetBungieNetUserById</a> 요청을 날려보자.</p>\n<p>API 문서에 따르면 GetBungieNetUserById 요청은 GET 메소드를 사용하고 주소는 <code class=\"language-text\">/User/GetBungieNetUserById/:id/</code>이다.</p>\n<p>루트 엔드포인트가 <code class=\"language-text\">https://www.bungie.net/Platform</code>이므로, 이 요청의 엔드포인트는 다음과 같다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">https://www.bungie.net/Platform/User/GetBungieNetUserById/:id/</code></pre></div>\n<p>여기서 Path의 <code class=\"language-text\">:id</code>는 <code class=\"language-text\">membership_id</code>를 말한다.</p>\n<p>인증을 위해 <code class=\"language-text\">Authorization</code> 헤더에는 위에서 받은 사용자의 <code class=\"language-text\">access_token</code>을 <code class=\"language-text\">token_type</code>대로(Bearer) 넣어주고, <code class=\"language-text\">X-API-Key</code> 헤더에는 내 App의 API Key를 넣어줘야 한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">// import axios from 'axios';</span>\n\n<span class=\"token comment\">// 예시 코드 </span>\n<span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> axios<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>\n  <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">https://www.bungie.net/Platform/User/GetBungieNetUserById/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>__MEMBERSHIP_ID<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 정보를 가져올 사용자의 membership_id</span>\n  <span class=\"token punctuation\">{</span>\n    headers<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      Authorization<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Bearer </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>__ACCESS_TOKEN<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 사용자의 OAuth Access Token</span>\n      <span class=\"token string-property property\">'X-API-Key'</span><span class=\"token operator\">:</span> __API_KEY<span class=\"token punctuation\">,</span> <span class=\"token comment\">// 내 App의 API Key</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>그럼 아래와 같은 형식의 데이터가 온다.</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token comment\">// 예시 응답</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"Response\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">\"membershipId\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"24118779\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"uniqueName\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Elenchus#5501\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"displayName\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Elenchus\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"profilePicture\"</span><span class=\"token operator\">:</span> <span class=\"token number\">70507</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"profileTheme\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1131</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"userTitle\"</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"successMessageFlags\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"0\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"isDeleted\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"about\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"firstAccess\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"2019-12-02T11:44:05.075Z\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"lastUpdate\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"2020-11-02T22:44:57.408Z\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"context\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token property\">\"isFollowing\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n            <span class=\"token property\">\"ignoreStatus\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token property\">\"isIgnored\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n                <span class=\"token property\">\"ignoreFlags\"</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"showActivity\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"locale\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"en\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"localeInheritDefault\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"showGroupMessaging\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"profilePicturePath\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/img/profile/avatars/Destiny16.jpg\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"profileThemeName\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"d2_31\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"userTitleDisplay\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Newbie\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"statusText\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"statusDate\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"0001-01-01T00:00:00Z\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"steamDisplayName\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Elenchus\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"cachedBungieGlobalDisplayName\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Elenchus\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"cachedBungieGlobalDisplayNameCode\"</span><span class=\"token operator\">:</span> <span class=\"token number\">5501</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"ErrorCode\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"ThrottleSeconds\"</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"ErrorStatus\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Success\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"Message\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Ok\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"MessageData\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2>그리고…</h2>\n<p><a href=\"https://www.npmjs.com/package/bungie-api-ts\">bungie-api-ts</a>라는 패키지도 있다. 써보자.</p>","frontmatter":{"title":"Bungie.Net API 사용하기 기초","date":"2022년 04월 21일","description":"Destiny와 관련된 서비스 개발을 위해 Bungie.Net API를 사용하는 법을 간단하게 알아보자.","tags":["Bungie","OAuth"]}},"previous":{"fields":{"slug":"/use-supercharge-promise-pool/"},"frontmatter":{"title":"Supercharge Promise Pool로 Promise 배치 실행하기"}},"next":null},"pageContext":{"id":"ba893626-4891-5358-bea6-3f0053714a6e","previousPostId":"636e0bf3-193a-56ba-954b-c8e7d9d051de","nextPostId":null}},
    "staticQueryHashes": ["3000541721","3274528899"]}